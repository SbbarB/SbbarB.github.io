<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Closet - Clueless Style</title>

    <!-- Tailwind CSS framework for styling -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- TensorFlow.js for ML model inference -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.22.0/dist/tf.min.js"></script>

    <!-- Teachable Machine library for image classification -->
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8.5/dist/teachablemachine-image.min.js"></script>

    <!-- Custom styles and animations -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="gradient-bg min-h-screen">
    <!-- ========== NAVIGATION HEADER ========== -->
    <nav class="glass sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-pink-400 to-purple-600 rounded-full flex items-center justify-center">
                        <span class="text-white text-xl">‚ú®</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-white">Digital Closet</h1>
                        <div class="flex items-center gap-2">
                            <p class="text-pink-200 text-sm">Clueless Style AI</p>
                            <div id="modelStatus" class="text-xs px-2 py-1 rounded bg-yellow-500/20 text-yellow-200 flex items-center gap-1">
                                <div class="w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></div>
                                Loading Model...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Weather widget with location-based API integration -->
                <div id="weatherWidget" class="weather-widget px-4 py-2 rounded-full text-white font-medium">
                    <button onclick="getWeather()" class="flex items-center space-x-2">
                        <span id="weatherIcon">üå§Ô∏è</span>
                        <span id="weatherText">Get Weather</span>
                    </button>
                </div>
            </div>

            <!-- Main tab navigation for different app sections -->
            <div class="flex justify-center mt-4 space-x-2">
                <button onclick="showTab('closet')" id="tab-closet" class="tab-button active px-6 py-3 rounded-lg font-medium transition-all">
                    üëó My Closet
                </button>
                <button onclick="showTab('upload')" id="tab-upload" class="tab-button px-6 py-3 rounded-lg font-medium transition-all">
                    üì∏ Add Items
                </button>
                <button onclick="showTab('outfit')" id="tab-outfit" class="tab-button px-6 py-3 rounded-lg font-medium transition-all">
                    ‚ú® Pick Outfit
                </button>
                <button onclick="showTab('tryon')" id="tab-tryon" class="tab-button px-6 py-3 rounded-lg font-medium transition-all">
                    üé≠ Try On
                </button>
            </div>
        </div>
    </nav>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="max-w-7xl mx-auto px-6 py-8">

        <!-- ===== CLOSET VIEW ===== -->
        <!-- Display all clothing items with AI classification -->
        <div id="closet-tab" class="tab-content">
            <div class="glass rounded-3xl p-8">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-white mb-4">My Digital Closet</h2>
                    <p class="text-white/80 text-lg">
                        <span id="itemCount">0</span> items organized by AI ‚Ä¢
                        <button onclick="clearAllItems()" class="text-red-300 hover:text-red-200 underline ml-2">Clear All</button>
                    </p>
                </div>

                <!-- Category Filters -->
                <div class="mb-8">
                    <div class="flex flex-wrap justify-center gap-3">
                        <button onclick="filterCategory('all')" class="filter-btn active bg-white/20 text-white px-4 py-2 rounded-full">All</button>
                        <button onclick="filterCategory('shirt')" class="filter-btn bg-white/10 text-white/80 px-4 py-2 rounded-full">Tops</button>
                        <button onclick="filterCategory('pants')" class="filter-btn bg-white/10 text-white/80 px-4 py-2 rounded-full">Bottoms</button>
                        <button onclick="filterCategory('dress')" class="filter-btn bg-white/10 text-white/80 px-4 py-2 rounded-full">Dresses</button>
                        <button onclick="filterCategory('shoes')" class="filter-btn bg-white/10 text-white/80 px-4 py-2 rounded-full">Shoes</button>
                        <button onclick="filterCategory('jacket')" class="filter-btn bg-white/10 text-white/80 px-4 py-2 rounded-full">Outerwear</button>
                    </div>
                </div>

                <!-- Responsive grid of clothing items, dynamically populated -->
                <div id="clothingGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                    <div class="col-span-full text-center py-16">
                        <div class="text-6xl mb-4">üëó</div>
                        <h3 class="text-2xl font-semibold text-white mb-2">Your closet is empty</h3>
                        <p class="text-white/70">Start by adding some clothing items!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== UPLOAD VIEW ===== -->
        <!-- Upload and classify clothing images with AI -->
        <div id="upload-tab" class="tab-content hidden">
            <div class="glass rounded-3xl p-8">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-white mb-4">Add Clothing Items</h2>
                    <p class="text-white/80 text-lg">Upload multiple images to quickly populate your closet</p>
                </div>

                <!-- Upload Area -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <div id="uploadArea" class="upload-area rounded-2xl p-8 text-center cursor-pointer h-80 flex flex-col items-center justify-center">
                            <div class="text-6xl mb-4">üì∏</div>
                            <h3 class="text-xl font-semibold text-white mb-2">Upload Images</h3>
                            <p class="text-white/70 mb-4">Click to select multiple clothing photos</p>
                            <div class="text-sm text-white/50">Supports: JPG, PNG, WEBP</div>
                        </div>
                        <input type="file" id="fileInput" multiple accept="image/*" class="hidden">
                    </div>

                    <!-- Real-time AI classification results -->
                    <div id="processingArea" class="space-y-4">
                        <h3 class="text-xl font-semibold text-white">AI Classification</h3>
                        <div id="processingResults" class="bg-white/10 rounded-2xl p-6 h-64 overflow-y-auto">
                            <div class="text-center text-white/60 py-8">
                                <div class="text-4xl mb-2">ü§ñ</div>
                                <p>Select images to see AI classification results</p>
                            </div>
                        </div>
                        <button id="addItemsBtn" onclick="addProcessedItems()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-3 rounded-xl font-semibold transition-all hidden">
                            Add Items to Closet
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== OUTFIT PICKER VIEW ===== -->
        <!-- AI-powered outfit generation with weather and style preferences -->
        <div id="outfit-tab" class="tab-content hidden">
            <div class="glass rounded-3xl p-8">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-white mb-4">Pick Your Outfit</h2>
                    <p class="text-white/80 text-lg">AI-powered outfit selection based on weather and style</p>
                </div>

                <!-- User style and color preferences for smart outfit generation -->
                <div class="glass rounded-2xl p-6 mb-6">
                    <h3 class="text-xl font-semibold text-white mb-4 text-center">üé® Style Preferences</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Color Preferences -->
                        <div>
                            <label class="block text-white/80 text-sm mb-3">Preferred Colors</label>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="toggleColorPreference('black')" class="color-pref bg-gray-800 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Black</button>
                                <button onclick="toggleColorPreference('white')" class="color-pref bg-gray-100 text-black px-3 py-2 rounded-full text-sm border-2 border-transparent">White</button>
                                <button onclick="toggleColorPreference('blue')" class="color-pref bg-blue-500 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Blue</button>
                                <button onclick="toggleColorPreference('red')" class="color-pref bg-red-500 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Red</button>
                                <button onclick="toggleColorPreference('green')" class="color-pref bg-green-500 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Green</button>
                                <button onclick="toggleColorPreference('gray')" class="color-pref bg-gray-500 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Gray</button>
                                <button onclick="toggleColorPreference('pink')" class="color-pref bg-pink-500 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Pink</button>
                                <button onclick="toggleColorPreference('purple')" class="color-pref bg-purple-500 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Purple</button>
                            </div>
                        </div>

                        <!-- Style Preferences -->
                        <div>
                            <label class="block text-white/80 text-sm mb-3">Preferred Styles</label>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="toggleStylePreference('casual')" class="style-pref bg-white/20 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Casual</button>
                                <button onclick="toggleStylePreference('formal')" class="style-pref bg-white/20 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Formal</button>
                                <button onclick="toggleStylePreference('sporty')" class="style-pref bg-white/20 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Sporty</button>
                                <button onclick="toggleStylePreference('trendy')" class="style-pref bg-white/20 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Trendy</button>
                                <button onclick="toggleStylePreference('vintage')" class="style-pref bg-white/20 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Vintage</button>
                                <button onclick="toggleStylePreference('minimalist')" class="style-pref bg-white/20 text-white px-3 py-2 rounded-full text-sm border-2 border-transparent">Minimalist</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Weather Info Display -->
                <div id="weatherInfo" class="glass rounded-xl p-4 mb-6 text-center hidden">
                    <h4 class="text-white font-medium mb-2">üå§Ô∏è Current Weather</h4>
                    <div id="weatherDetails" class="text-white/80 text-sm"></div>
                </div>

                <!-- Smart Controls -->
                <div class="flex flex-wrap justify-center gap-4 mb-8">
                    <button onclick="generateSmartOutfit()" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105">
                        ‚ú® Smart Outfit
                    </button>
                    <button onclick="generateRandomOutfit()" class="bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105">
                        üé≤ Random Pick
                    </button>
                    <button onclick="clearOutfit()" class="bg-gray-600 hover:bg-gray-700 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all">
                        üîÑ Clear
                    </button>
                </div>

                <!-- AI-calculated outfit compatibility based on color, style, and weather -->
                <div id="compatibilityScore" class="bg-white/10 rounded-2xl p-6 mb-8 text-center hidden">
                    <h3 class="text-xl font-semibold text-white mb-4">üíñ Outfit Compatibility</h3>
                    <div class="flex items-center justify-center gap-4">
                        <div class="w-48 h-3 bg-white/20 rounded-full overflow-hidden">
                            <div id="scoreBar" class="h-full bg-gradient-to-r from-pink-400 to-purple-500 transition-all duration-1000"></div>
                        </div>
                        <span id="scoreText" class="text-white font-bold text-xl">0%</span>
                    </div>
                </div>

                <!-- Dynamic outfit categories with rotation controls -->
                <div id="outfitCategories" class="space-y-6">
                    <!-- Populated by renderOutfitCategories() -->
                </div>

                <!-- Selected Outfit Preview -->
                <div id="selectedOutfitPreview" class="hidden bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-6 mt-8 border border-white/20">
                    <h3 class="text-2xl font-bold text-white mb-4 text-center">‚ú® Your Selected Outfit</h3>
                    <div id="outfitPreviewGrid" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== VIRTUAL TRY-ON VIEW ===== -->
        <div id="tryon-tab" class="tab-content hidden">
            <!-- Fullscreen AR Try-On (when active) -->
            <div id="arFullscreen" class="fixed inset-0 z-50 hidden">
                <!-- Fullscreen Camera Video -->
                <video id="arCameraVideo" autoplay muted playsinline style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; object-fit: cover; z-index: 1;"></video>

                <!-- Canvas for 3D Clothing Overlay -->
                <canvas id="arOverlayCanvas" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 2; pointer-events: none;"></canvas>

                <!-- AR Control Panels -->
                <div style="position: fixed; top: 16px; left: 16px; max-width: 300px; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); border-radius: 12px; padding: 16px; z-index: 10;">
                    <h2 class="text-lg font-semibold mb-3 text-white">üëó AR Clothing Try-On</h2>

                    <!-- Status -->
                    <div class="mb-4 text-sm space-y-1">
                        <div id="arPoseStatus">
                            <span class="arStatusDot" style="width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 6px; background-color: #fbbf24; animation: pulse 1.5s infinite;"></span>
                            <span class="text-white">Pose Detection: Loading...</span>
                        </div>
                    </div>

                    <!-- Exit AR -->
                    <button onclick="exitAR()"
                            class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors mb-3">
                        ‚ùå Exit AR Mode
                    </button>

                    <!-- Current Outfit Display -->
                    <div id="arCurrentOutfitDisplay" class="text-center text-white/60 mb-3">
                        <p class="text-sm">Current outfit will show here</p>
                    </div>
                </div>

                <!-- AR Controls Panel -->
                <div id="arControlsPanel" style="position: fixed; top: 16px; right: 16px; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); border-radius: 12px; padding: 16px; z-index: 10; display: none;">
                    <h3 class="text-lg font-semibold mb-3 text-white">üéÆ AR Controls</h3>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm mb-1 text-white">Scale: <span id="arScaleValue">1.0</span></label>
                            <input type="range" id="arScaleSlider" min="0.5" max="3" step="0.1" value="1"
                                   onchange="updateARClothingTransform()" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm mb-1 text-white">Offset Y: <span id="arOffsetValue">0</span></label>
                            <input type="range" id="arOffsetSlider" min="-100" max="100" step="5" value="0"
                                   onchange="updateARClothingTransform()" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm mb-1 text-white">Width: <span id="arWidthValue">1.6</span></label>
                            <input type="range" id="arWidthSlider" min="0.8" max="2.5" step="0.1" value="1.6"
                                   onchange="updateARClothingTransform()" class="w-full">
                        </div>
                        <div class="flex gap-2 mb-2">
                            <button onclick="toggleARClothing()" id="arToggleBtn"
                                    class="flex-1 bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 rounded-lg transition-colors text-sm">
                                üëÅÔ∏è Toggle
                            </button>
                            <button onclick="resetARTransform()"
                                    class="flex-1 bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-2 rounded-lg transition-colors text-sm">
                                üîÑ Reset
                            </button>
                        </div>
                        <button onclick="toggleARDebugMode()" id="arDebugBtn"
                                class="w-full bg-gray-600 hover:bg-gray-700 text-white px-3 py-2 rounded-lg transition-colors text-sm">
                            üîß Debug
                        </button>
                    </div>
                </div>

                <!-- Debug Info -->
                <div style="position: fixed; bottom: 16px; right: 16px; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); border-radius: 12px; padding: 16px; z-index: 10; display: none;" id="arDebugInfo">
                    <div class="text-xs text-white space-y-1">
                        <div>FPS: <span id="arFpsCounter">0</span></div>
                        <div>Person Detected: <span id="arPersonDetected">‚ùå</span></div>
                        <div>Clothing Active: <span id="arClothingActive">‚ùå</span></div>
                        <div>Body Parts: <span id="arBodyParts">0</span></div>
                    </div>
                </div>
            </div>

            <!-- Regular Try-On View -->
            <div class="glass rounded-3xl p-8">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-white mb-4">Virtual Try-On</h2>
                    <p class="text-white/80 text-lg">Experience your outfit with advanced AR technology</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- AR Preview -->
                    <div class="lg:col-span-2">
                        <div class="bg-black/30 rounded-2xl p-6 h-96 relative overflow-hidden">
                            <div class="flex flex-col items-center justify-center h-full text-white">
                                <div class="text-6xl mb-4">üé≠</div>
                                <h3 class="text-2xl font-semibold mb-4">AR Try-On Camera</h3>
                                <p class="text-white/70 mb-6 text-center">Start the AR camera to see your outfit in real-time</p>
                                <button onclick="startARTryOn()" class="bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white px-8 py-4 rounded-xl font-semibold transition-all transform hover:scale-105">
                                    üöÄ Start AR Try-On
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Controls & Info -->
                    <div class="space-y-6">
                        <div class="glass rounded-xl p-4">
                            <h3 class="text-white font-semibold mb-3">üëó Current Outfit</h3>
                            <div id="currentOutfitDisplay" class="space-y-2">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>

                        <div class="glass rounded-xl p-4">
                            <h3 class="text-white font-semibold mb-3">‚ÑπÔ∏è How it Works</h3>
                            <div class="text-white/70 text-sm space-y-2">
                                <p>‚Ä¢ Select clothing items from your closet</p>
                                <p>‚Ä¢ Start the AR camera for real-time preview</p>
                                <p>‚Ä¢ Adjust fit and positioning with controls</p>
                                <p>‚Ä¢ AI tracks your body for realistic placement</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ========== EDIT ITEM MODAL ========== -->
    <!-- Modal for editing clothing item properties -->
    <div id="editModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4" onclick="if(event.target === this) closeEditModal()">
        <div class="glass rounded-3xl p-8 max-w-md w-full">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-white">Edit Item</h2>
                <button onclick="closeEditModal()" class="text-white/70 hover:text-white text-2xl">√ó</button>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-white/80 text-sm mb-2">Category</label>
                    <select id="editCategory" class="w-full bg-white/10 text-white border border-white/20 rounded-lg px-4 py-2">
                        <option value="long sleeve shirt">Long Sleeve Shirt</option>
                        <option value="short sleeve shirt">Short Sleeve Shirt</option>
                        <option value="tank">Tank</option>
                        <option value="sweater">Sweater</option>
                        <option value="pants">Pants</option>
                        <option value="shorts">Shorts</option>
                        <option value="long skirt">Long Skirt</option>
                        <option value="short skirt">Short Skirt</option>
                        <option value="long dress">Long Dress</option>
                        <option value="short dress">Short Dress</option>
                        <option value="coat">Coat</option>
                        <option value="shoes">Shoes</option>
                        <option value="bag">Bag</option>
                        <option value="glasses">Glasses</option>
                    </select>
                </div>

                <div>
                    <label class="block text-white/80 text-sm mb-2">Color</label>
                    <input type="text" id="editColor" class="w-full bg-white/10 text-white border border-white/20 rounded-lg px-4 py-2" placeholder="e.g., blue, red, black">
                </div>

                <div>
                    <label class="block text-white/80 text-sm mb-2">Style</label>
                    <select id="editStyle" class="w-full bg-white/10 text-white border border-white/20 rounded-lg px-4 py-2">
                        <option value="casual">Casual</option>
                        <option value="formal">Formal</option>
                        <option value="athletic">Athletic</option>
                        <option value="trendy">Trendy</option>
                        <option value="vintage">Vintage</option>
                        <option value="minimalist">Minimalist</option>
                    </select>
                </div>

                <div>
                    <label class="block text-white/80 text-sm mb-2">Description (optional)</label>
                    <textarea id="editDescription" class="w-full bg-white/10 text-white border border-white/20 rounded-lg px-4 py-2 h-24 resize-none" placeholder="Add notes about this item..."></textarea>
                </div>

                <div class="flex gap-3 mt-6">
                    <button onclick="saveEditedItem(event)" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-3 rounded-xl font-semibold transition-all">
                        Save Changes
                    </button>
                    <button onclick="closeEditModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-xl font-semibold transition-all">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== JAVASCRIPT ========== -->
    <!-- Complete app logic extracted from digital-closet-final.html -->
    <script src="js/app.js"></script>
</body>
</html>
